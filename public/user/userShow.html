<div layout="column">
    <div style="background: url({{userProfile.backgroundImage || 'http://orig11.deviantart.net/20eb/f/2015/030/6/f/_minflat__dark_material_design_wallpaper__4k__by_dakoder-d8fjqzu.jpg'}});
    background-size: cover; height: 400px; width: 100%;"></div>
    <div layout="row" layout-align="center center">
        <img ng-src="{{userProfile.avatarFull}}" alt="" class="md-avatar circle" style="margin-top: -92px; border: 2px solid #FFF;">
    </div>
    <div layout="row">
        <div flex></div>
        <div layout="column" layout-align="center center">
            <div layout="row" layout-align="center center">
                <span class="md-display-2 wrap-title icon">{{userProfile.name}}</span>
                <div>
                    <md-icon md-colors="{color: 'green-500'}" ng-if="userProfile.onlineStatus === 'Online'">check_circle</md-icon>
                    <md-icon md-colors="{color: 'yellow-500'}" ng-if="userProfile.onlineStatus === 'Away'">access_time</md-icon>
                    <md-icon md-colors="{color: 'red-A700'}"  ng-if="userProfile.onlineStatus === 'Busy'">do_not_disturb_on</md-icon>
                    <md-icon md-colors="{color: 'grey-A700'}"  ng-if="userProfile.onlineStatus === 'Offline'">offline_pin</md-icon>
                    <md-tooltip md-colors="{color: 'DTPDark-accent-900'}">{{userProfile.onlineStatus}}</md-tooltip>
                </div>
            </div>
            <span class="md-headline">{{userProfile.rank}}</span>
        </div>
        <div flex></div>
    </div>
    <br>
    <div layout-gt-sm="row" layout="column">
        <div flex></div>
        <div flex-gt-sm="30" flex="100">
            <md-card>
                <md-card-header layout="row">
                    <md-card-header-text>
                        <span class="md-headline">About</span>
                    </md-card-header-text>
                    <span flex></span>
                    <md-button class="md-icon-button" ng-if="userProfile._id === user._id && !editingAbout" ng-click="editingAboutToggle()"><md-icon>edit</md-icon></md-button>
                </md-card-header>
                <md-card-content flex ng-if="!editingAbout">
                    <md-button style="margin: 0;" ng-href="{{userProfile.profileUrl}}">Steam Profile</md-button>
                    <p class="md-subhead wrap-content"><span md-colors="{color: 'grey-500'}">Joined: </span>{{userProfile.createdAt | date: 'medium'}}</p>
                    <p class="md-subhead wrap-content"><span md-colors="{color: 'grey-500'}">Name: </span>{{userProfile.realName}}</p>
                    <p class="md-subhead wrap-content"><span md-colors="{color: 'grey-500'}">Gender: </span>{{userProfile.gender}}</p>
                    <p class="md-subhead wrap-content"><span md-colors="{color: 'grey-500'}">Age: </span>{{userProfile.age}}</p>
                    <p class="md-subhead wrap-content"><span md-colors="{color: 'grey-500'}">Birthday: </span>{{userProfile.birthday | date: 'longDate'}}</p>
                    <p class="md-subhead wrap-content"><span md-colors="{color: 'grey-500'}">Location: </span>{{userProfile.location}}</p>
                    <p class="md-subhead wrap-content"><span md-colors="{color: 'grey-500'}">Occupation: </span>{{userProfile.occupation}}</p>
                </md-card-content>
                <md-card-content flex ng-if="editingAbout">
                    <form>
                        <p class="md-subhead wrap-content">Joined: {{userProfile.createdAt | date: 'medium'}}</p>
                        <md-input-container class="md-block">
                            <label>Name</label>
                            <input ng-model="about.realName">
                        </md-input-container>
                        <md-input-container class="md-block">
                            <label>Gender</label>
                            <input ng-model="about.gender">
                        </md-input-container>
                        <md-input-container class="md-block">
                            <label>Age</label>
                            <input ng-model="about.age">
                        </md-input-container>
                        <md-input-container class="md-block">
                            <label>Birthday</label>
                        </md-input-container>
                        <br>
                        <md-datepicker class="md-primary" ng-model="about.birthday"></md-datepicker>
                        <md-input-container class="md-block">
                            <label>Location</label>
                            <input ng-model="about.location">
                        </md-input-container>
                        <md-input-container class="md-block">
                            <label>Occupation</label>
                            <input ng-model="about.occupation">
                        </md-input-container>
                    </form>
                </md-card-content>
                <md-card-actions layout="row" ng-if="editingAbout">
                    <span flex></span>
                    <md-button class="md-primary" ng-click="editingAboutToggle()">Cancel</md-button>
                    <md-button class="md-primary md-raised" ng-click="saveProfile(about)">Save</md-button>
                </md-card-actions>
            </md-card>
        </div>
        <div layout="row" flex-gt-sm="50" flex="100">
            <md-card flex>
                <md-card-header layout="row">
                    <md-card-header-text>
                        <span class="md-headline">Summary</span>
                    </md-card-header-text>
                    <span flex></span>
                    <md-button class="md-icon-button" ng-if="userProfile._id === user._id && !editingBio" ng-click="editingBioToggle()"><md-icon>edit</md-icon></md-button>
                </md-card-header>
                <md-card-content flex ng-if="!editingBio">
                    <p class="md-subhead wrap-content">{{userProfile.bio || 'No information given'}}</p>
                </md-card-content>
                <md-card-content flex ng-if="editingBio">
                    <form>
                        <md-input-container class="md-block">
                            <label>Summary</label>
                            <textarea ng-model="bio.bio"></textarea>
                        </md-input-container>
                    </form>
                </md-card-content>
                <md-card-actions layout="row" ng-if="editingBio">
                    <span flex></span>
                    <md-button class="md-primary" ng-click="editingBioToggle()">Cancel</md-button>
                    <md-button class="md-primary md-raised" ng-click="saveProfile(bio)">Save</md-button>
                </md-card-actions>
            </md-card>
        </div>
        <div flex></div>
    </div>
    <!-- Permissions -->
    <div layout="row" ng-if="user.roles.includes('Staff')">
        <div flex-gt-sm="5"></div>
        <md-card flex-gt-sm="90" flex="100">
            <md-card-header layout="row">
                <md-card-header-text>
                    <span class="md-headline">Permissions</span>
                </md-card-header-text>
                <span flex></span>
                <md-button class="md-icon-button" ng-if="user.roles.includes('Super Admin') && !editingPermissions && permissionsOpen" ng-click="editingPermissionsToggle()"><md-icon>edit</md-icon></md-button>
            </md-card-header>
            <md-card-content ng-if="permissionsOpen">
                <md-list>
                    <md-list-item>
                        <md-input-container>
                            <label>Rank</label>
                            <md-select class="md-primary" ng-model="permissions.rank" ng-disabled="!editingPermissions">
                                <md-option ng-repeat="rank in ranks" ng-value="rank">
                                    {{rank}}
                                </md-option>
                            </md-select>
                        </md-input-container>
                    </md-list-item>
                    <div ng-repeat="(permissionGroup, permissions) in userProfile.permissions">
                        <md-subheader class="md-no-sticky md-primary" style="background: transparent"><span class="md-title">{{permissionGroup}}</span></md-subheader>
                        <md-list-item ng-repeat="(permission, value) in permissions">
                            <p>{{permission}}</p>
                            <md-switch class="md-primary md-secondary" ng-model="permissions[permission]" ng-disabled="!editingPermissions"></md-switch>
                        </md-list-item>
                        <md-divider></md-divider>
                    </div>
                </md-list>
            </md-card-content>
            <md-card-actions layout="row">
                <md-button class="md-primary" ng-click="togglePermissions()" ng-hide="editingPermissions">
                    <span ng-hide="permissionsOpen">Show Permissions <md-icon>arrow_drop_down</md-icon></span>
                    <span ng-show="permissionsOpen">Hide Permissions <md-icon>arrow_drop_up</md-icon></span>
                </md-button>
                <span flex></span>
                <div ng-if="editingPermissions">
                    <md-button class="md-primary" ng-click="editingPermissionsToggle()">Cancel</md-button>
                    <md-button class="md-primary md-raised" ng-click="savePermissions()">Save</md-button>
                </div>
            </md-card-actions>
        </md-card>
        <div flex-gt-sm="5"></div>
    </div>
</div>
